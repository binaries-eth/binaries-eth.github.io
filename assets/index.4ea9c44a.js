var T=Object.defineProperty;var $=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var B=(e,t,a)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,b=(e,t)=>{for(var a in t||(t={}))P.call(t,a)&&B(e,a,t[a]);if($)for(var a of $(t))q.call(t,a)&&B(e,a,t[a]);return e};import{d as defineComponent,t as toRefs,r as ref,o as onMounted,w as watchEffect,a as onUnmounted,b as openBlock,c as createElementBlock,e as createBaseVNode,u as unref,n as normalizeClass,f as toDisplayString,g as withModifiers,p as pushScopeId,h as popScopeId,W as Web3Provider,i as reactive,j as computed,I as InfuraProvider,C as Contract,k as watch,l as provide,m as readonly,q as renderSlot,s as utils,v as toRaw,B as BigNumber,x as inject,y as createVNode,z as isRef,F as Fragment,A as renderList,D as createCommentVNode,E as createBlock,G as createTextVNode,H as withCtx,J as createApp}from"./vendor.3cf1d123.js";const p=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}};p();var TokenRenderer_vue_vue_type_style_index_0_scoped_true_lang="",_export_sfc=(e,t)=>{for(const[a,o]of t)e[a]=o;return e};const _hoisted_1$7=["width","height"],_sfc_main$8=defineComponent({props:{formula:{type:String,required:!0},params:{type:Array,required:!0},size:{type:Number,required:!0},scaled:{type:Boolean,required:!1},fillStyle:{type:String,required:!1}},setup(__props){const props=__props,{formula,params}=toRefs(props),canvas=ref(null),{size}=props,sanitizedEval=f=>(f=f.replace(/[^a-zA-Z0-9=<>*+-\/().&^!|%;?:;{}]/g,""),eval(`({x,y,p1,p2,p3,p4,p5,p6,p7,p8,p9}) => ${f}`)),parseParams=e=>Object.fromEntries(e.map((t,a)=>[`p${a+1}`,t])),draw=(e,t,a,o)=>{try{let n=sanitizedEval(a),s=parseParams(o);e.clearRect(0,0,t,t);let r=b({},s);for(r.x=-t/2;r.x<t/2;r.x++)for(r.y=-t/2;r.y<t/2;r.y++)n(r)&&e.fillRect(r.x+t/2,r.y+t/2,1,1)}catch(n){console.log(n)}};let stopWatching;return onMounted(()=>{const t=canvas.value.getContext("2d");t.fillStyle=props.fillStyle||"#ddd",stopWatching=watchEffect(()=>draw(t,size,formula.value,params.value))}),onUnmounted(()=>{stopWatching()}),(e,t)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["renderer",{scaled:__props.scaled}])},[createBaseVNode("canvas",{class:"canvas",ref:(a,o)=>{o.canvas=a,canvas.value=a},width:unref(size),height:unref(size)},null,8,_hoisted_1$7)],2))}});var TokenRenderer=_export_sfc(_sfc_main$8,[["__scopeId","data-v-597bb71a"]]);const _hoisted_1$6={class:"text-input"},_hoisted_2$6=createBaseVNode("label",null,"forumla",-1),_hoisted_3$5=["value"],_sfc_main$7=defineComponent({props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const a=n=>{var s;((s=n.key.match(/[^ \[\]a-zA-Z0-9=<>*+-\/().&^!|%;?:]/))==null?void 0:s.length)&&n.preventDefault()},o=n=>{t("update:modelValue",n.target.value)};return(n,s)=>(openBlock(),createElementBlock("div",_hoisted_1$6,[_hoisted_2$6,createBaseVNode("input",{type:"text",value:e.modelValue,onKeydown:s[0]||(s[0]=r=>a(r)),onInput:s[1]||(s[1]=r=>o(r))},null,40,_hoisted_3$5)]))}});var ParameterInput_vue_vue_type_style_index_0_scoped_true_lang="";const _hoisted_1$5={class:"text-input"},_hoisted_2$5=["value"],_hoisted_3$4=["value"],_sfc_main$6=defineComponent({props:{label:{type:String,required:!0},modelValue:{type:Number,required:!0,default:()=>1}},emits:["update:modelValue"],setup(e,{emit:t}){return(a,o)=>(openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("label",null,toDisplayString(e.label),1),createBaseVNode("input",{type:"number",min:"0",max:"255",value:e.modelValue,onInput:o[0]||(o[0]=n=>t("update:modelValue",parseInt(n.target.value)))},null,40,_hoisted_2$5),createBaseVNode("input",{type:"range",min:"0",max:"255",step:"1",value:e.modelValue,onInput:o[1]||(o[1]=n=>t("update:modelValue",parseInt(n.target.value)))},null,40,_hoisted_3$4)]))}});var ParameterInput=_export_sfc(_sfc_main$6,[["__scopeId","data-v-5ac7c146"]]),MintButton_vue_vue_type_style_index_0_scoped_true_lang="";const _withScopeId$2=e=>(pushScopeId("data-v-91b8c5c0"),e=e(),popScopeId(),e),_hoisted_1$4=["disabled"],_hoisted_2$4=_withScopeId$2(()=>createBaseVNode("span",{class:"shadow"},null,-1)),_hoisted_3$3=_withScopeId$2(()=>createBaseVNode("span",{class:"edge"},null,-1)),_hoisted_4$2=_withScopeId$2(()=>createBaseVNode("span",{class:"front"}," MINT ",-1)),_hoisted_5$1=[_hoisted_2$4,_hoisted_3$3,_hoisted_4$2],_sfc_main$5=defineComponent({props:{minting:{type:Boolean,required:!0},disabled:{type:Boolean,required:!0}},emits:["click"],setup(e,{emit:t}){return(a,o)=>(openBlock(),createElementBlock("button",{disabled:e.disabled,class:normalizeClass(["pushable",{minting:e.minting}]),onClick:o[0]||(o[0]=withModifiers(n=>t("click"),["stop","prevent"]))},_hoisted_5$1,10,_hoisted_1$4))}});var MintButton=_export_sfc(_sfc_main$5,[["__scopeId","data-v-91b8c5c0"]]);const initMetamask=async e=>{const t=window.ethereum||window.web3&&window.web3.currentProvider;if(t){const a=new Web3Provider(t,"any");a.on("network",(m,h)=>{i(m.chainId)});const o=ref({}),n=ref([]),s=ref(0),r=m=>{n.value=m,o.value=a.getSigner()},i=m=>{s.value=m};t.on("accountsChanged",r);const d=async()=>{r(await a.listAccounts())};return{signer:o,chainId:s,accounts:n,connect:async()=>{s.value!=e&&await t.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x"+e.toString(16)}]}),d(),n.value.length==0&&await t.request({method:"eth_requestAccounts"})},checkConnection:d,clearListeners:()=>{t.removeListener("accountsChanged",r)}}}else return Promise.reject("So far we just support Metamask \u{1F98A}")},{formatEther}=utils,contractAddress="0xa8A0d755b9466162672179570c548842Ecf5A47f",networkId=parseInt("42"),contractAbi=["function name() view returns (string)","function totalSupply() view returns (uint)","function tokenMetadata(uint tokenId) view returns (tuple(address,address,string,uint[],uint,uint))","function tokenURI(uint tokenId) view returns (string)","function mintPrice(uint totalSupply) view returns (uint)","function mint(string formula, uint8[] params) payable returns (uint)"],state=reactive({totalSupply:0,accounts:[],account:computed(()=>state.accounts[0]),connected:computed(()=>state.validNetwork&&state.accounts.length>0),contractAddress,signer:void 0,listing:[],network:0,validNetwork:computed(()=>!!state.network&&state.network==networkId),nextPrice:"0",providerError:""}),infura=new InfuraProvider(networkId,"51db74c752774749a1a8aae509f4cd87"),infuraContract=new Contract(contractAddress,contractAbi,infura),fetchTokenMetadata=async e=>{let t=await infuraContract.tokenMetadata(e);return parseTokenMetadata(t)},fetchMintPrice=async e=>{const t=await infuraContract.mintPrice(e+1);return formatEther(t)};watch(()=>state.totalSupply,async(e,t)=>{state.nextPrice=await fetchMintPrice(e)});const fetchTotalSupply=async()=>{state.totalSupply=(await infuraContract.totalSupply()).toNumber()},parseTokenMetadata=e=>({owner:e[0],minter:e[1],attributes:{formula:e[2],params:e[3].map(t=>t.toNumber())},tokenId:e[4]}),fetchListing=async()=>{const e=await Promise.all(Array.apply(null,Array(state.totalSupply)).map(async(t,a)=>fetchTokenMetadata(a+1)));state.listing=e.sort((t,a)=>t.tokenId>a.tokenId?-1:1)},mint=async(e,t=[],a)=>{const o=new Contract(contractAddress,contractAbi,toRaw(state.signer)),n=await o.mintPrice(a.value+1),s=await(await o.mint(e,t,{value:n}).catch(handleVMException)).wait().catch(handleVMException),r=BigNumber.from(s.logs[0].topics[3]).toNumber();return handleMintedToken(r),r},handleMintedToken=async e=>{let t=await fetchTokenMetadata(e);state.listing.unshift(t),state.totalSupply+=1},handleVMException=e=>{let t="";if(e.code==4001)t="Signature rejected";else if(e.data.message.indexOf("(")>-1){t=e.data.message.match(/'(.*?)'/)[1];let a=t.split("(")[0],o=t.match(/\((.*?)\)/)[1].replace(" ","").split(",");switch(a){case"InsufficientFunds":t=parseInsufficientFunds({available:parseInt(o[0]),required:parseInt(o[1])})}}return Promise.reject(t)},parseInsufficientFunds=e=>`Transaction minumum amount ${e.required} ETH, sent ${e.available} ETH`,ContractStateSymbol=Symbol("Contract state provider identifier"),ContractCallsSymbol=Symbol("Contract calls provider identifier"),_sfc_main$4={setup(){let e;const t=async()=>{try{await e.connect()}catch(a){a.code===4001?handleVMException(a):console.log(a)}};provide(ContractStateSymbol,toRefs(readonly(state))),provide(ContractCallsSymbol,{mint,connect:t,fetchTotalSupply}),onMounted(async()=>{try{e=await initMetamask(networkId)}catch(a){state.providerError=a}e&&(await e.checkConnection(),state.accounts=e.accounts,state.network=e.chainId,state.signer=e.signer),await fetchTotalSupply(),await fetchListing()}),onUnmounted(()=>{e&&e.clearListeners()})}};function _sfc_render(e,t,a,o,n,s){return renderSlot(e.$slots,"default")}var ContractProvider=_export_sfc(_sfc_main$4,[["render",_sfc_render]]),TokenForm_vue_vue_type_style_index_0_scoped_true_lang="";const _hoisted_1$3={class:"center"},_hoisted_2$3={key:0},_hoisted_3$2={class:"center"},_hoisted_4$1=createTextVNode(" Current price "),_hoisted_5={class:"price"},_hoisted_6={class:"button-container"},_hoisted_7={key:2,href:"https://metamask.io",target:"_blank"},_hoisted_8={key:0,class:"center"},_hoisted_9={class:"error"},_sfc_main$3=defineComponent({props:{formulaValue:{type:String,required:!0},paramsValues:{type:Array,required:!0}},emits:["update:formulaValue","update:paramsValues"],setup(e,{emit:t}){const a=e,{mint:o,connect:n,fetchTotalSupply:s}=inject(ContractCallsSymbol),{connected:r,totalSupply:i,nextPrice:d,listing:v,providerError:k}=inject(ContractStateSymbol),m=ref(!0),h=ref(!1),y=ref(""),S=l=>{var c,u;return((u=(c=l.match(/p[0-9]+/g))==null?void 0:c.filter((_,g,A)=>A.indexOf(_)==g))==null?void 0:u.length)||0},w=computed(()=>Object.fromEntries(unref(v).map(l=>[[l.attributes.formula,...l.attributes.params].join(","),1]))),V=l=>!!w.value[l.join(",")],C=watch(()=>[a.formulaValue,...a.paramsValues],(l,c)=>{const u=S(l[0]);u!=a.paramsValues.length&&(a.paramsValues.length+=u-a.paramsValues.length,t("update:paramsValues",Array.apply(null,a.paramsValues).map(_=>_||1))),m.value=V(l),t("update:formulaValue",a.formulaValue)});watch(()=>w.value,()=>{m.value=V([a.formulaValue,...a.paramsValues])});const I=async()=>{h.value=!0;const l=a.formulaValue.replace(/[ ]/g,""),c=a.paramsValues;await o(l,c,i).catch(N),h.value=!1},N=async l=>{m.value=!1,y.value=l},x=()=>{y.value=""},E=l=>Math.floor(Math.random()*l),M=()=>{t("update:paramsValues",a.paramsValues.map(()=>E(255)))};return onMounted(async()=>{}),onUnmounted(()=>{C()}),(l,c)=>(openBlock(),createElementBlock("div",null,[createVNode(_sfc_main$7,{modelValue:e.formulaValue,"onUpdate:modelValue":c[0]||(c[0]=u=>isRef(formulaValue)?formulaValue.value=u:null)},null,8,["modelValue"]),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.paramsValues,(u,_)=>(openBlock(),createBlock(ParameterInput,{label:"P"+(_+1),modelValue:e.paramsValues[_],"onUpdate:modelValue":g=>e.paramsValues[_]=g,modelModifiers:{number:!0}},null,8,["label","modelValue","onUpdate:modelValue"]))),256)),createBaseVNode("div",_hoisted_1$3,[m.value?(openBlock(),createElementBlock("span",_hoisted_2$3,"These params are already minted")):createCommentVNode("",!0),createBaseVNode("span",{class:"link",onClick:c[1]||(c[1]=u=>M())},"(randomise)")]),createBaseVNode("div",_hoisted_3$2,[_hoisted_4$1,createBaseVNode("span",_hoisted_5,toDisplayString(unref(d))+"\u039E",1),createBaseVNode("span",{class:"link",onClick:c[2]||(c[2]=u=>unref(s)())},"(refresh)")]),createBaseVNode("div",_hoisted_6,[unref(r)?(openBlock(),createBlock(MintButton,{key:0,disabled:m.value||h.value,minting:h.value,onClick:c[3]||(c[3]=u=>I())},null,8,["disabled","minting"])):unref(k)?unref(k)?(openBlock(),createElementBlock("a",_hoisted_7,"(install Metamask \u{1F98A} to mint)")):createCommentVNode("",!0):(openBlock(),createElementBlock("span",{key:1,class:"link",onClick:c[4]||(c[4]=u=>unref(n)())},"(connect)"))]),y.value?(openBlock(),createElementBlock("div",_hoisted_8,[createBaseVNode("span",_hoisted_9,toDisplayString(y.value),1),createBaseVNode("span",{class:"link",onClick:c[5]||(c[5]=u=>x())},"(OK, close)")])):createCommentVNode("",!0)]))}});var TokenForm=_export_sfc(_sfc_main$3,[["__scopeId","data-v-04e1f88e"]]);const _hoisted_1$2={key:0},_hoisted_2$2={key:1},_hoisted_3$1={key:1},_sfc_main$2=defineComponent({setup(e){const{connect:t}=inject(ContractCallsSymbol),{connected:a,account:o,providerError:n}=inject(ContractStateSymbol);return(s,r)=>(openBlock(),createElementBlock("div",null,[unref(n)?(openBlock(),createElementBlock("div",_hoisted_1$2,toDisplayString(unref(n)),1)):(openBlock(),createElementBlock("div",_hoisted_2$2,[unref(a)?(openBlock(),createElementBlock("div",_hoisted_3$1," Connected as "+toDisplayString(unref(o)),1)):(openBlock(),createElementBlock("button",{key:0,onClick:r[0]||(r[0]=i=>unref(t)()),ref:(i,d)=>{d.connect_button=i}},"CONNECT",512))]))]))}});var TokenList_vue_vue_type_style_index_0_scoped_true_lang="";const _withScopeId$1=e=>(pushScopeId("data-v-27af4aba"),e=e(),popScopeId(),e),_hoisted_1$1=["onClick"],_hoisted_2$1=_withScopeId$1(()=>createBaseVNode("span",{class:"shadow"},null,-1)),_sfc_main$1=defineComponent({emits:["selected"],setup(e,{emit:t}){const a=n=>{const s=JSON.parse(JSON.stringify(n));t("selected",s)},{listing:o}=inject(ContractStateSymbol);return onMounted(async()=>{}),onUnmounted(()=>{}),(n,s)=>(openBlock(),createElementBlock("section",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(o),r=>(openBlock(),createElementBlock("div",{class:"box",onClick:i=>a(r),key:r.tokenId},[_hoisted_2$1,createVNode(TokenRenderer,{class:"front",scaled:"",formula:r.attributes.formula,params:r.attributes.params,size:512},null,8,["formula","params"])],8,_hoisted_1$1))),128))]))}});var TokenList=_export_sfc(_sfc_main$1,[["__scopeId","data-v-27af4aba"]]),App_vue_vue_type_style_index_0_scoped_true_lang="";const _withScopeId=e=>(pushScopeId("data-v-5767c46e"),e=e(),popScopeId(),e),_hoisted_1={class:"container"},_hoisted_2={class:"navigation"},_hoisted_3=_withScopeId(()=>createBaseVNode("span",{class:"logo"},"BINARIES",-1)),_hoisted_4={class:"grid"},_sfc_main=defineComponent({setup(e){const t=512,a=ref("!((x ^ y) % p1)"),o=ref([7]),n=ref(!1),s=i=>{n.value=i},r=i=>{a.value=i.attributes.formula,o.value=i.attributes.params};return(i,d)=>(openBlock(),createBlock(ContractProvider,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[_hoisted_3,createVNode(_sfc_main$2,{onConnected:s})]),createBaseVNode("div",_hoisted_4,[createVNode(TokenRenderer,{class:"shadow",formula:a.value,params:o.value,size:t},null,8,["formula","params"]),createVNode(TokenForm,{class:"editor","formula-value":a.value,"onUpdate:formula-value":d[0]||(d[0]=v=>a.value=v),"params-values":o.value,"onUpdate:params-values":d[1]||(d[1]=v=>o.value=v),connected:n.value},null,8,["formula-value","params-values","connected"])]),createVNode(TokenList,{onSelected:r})])]),_:1}))}});var App=_export_sfc(_sfc_main,[["__scopeId","data-v-5767c46e"]]),global="";createApp(App).mount("#app");
