var F=Object.defineProperty;var I=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var N=(e,t,a)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,x=(e,t)=>{for(var a in t||(t={}))O.call(t,a)&&N(e,a,t[a]);if(I)for(var a of I(t))U.call(t,a)&&N(e,a,t[a]);return e};import{d as defineComponent,t as toRefs,r as ref,o as onMounted,w as watchEffect,a as onUnmounted,b as openBlock,c as createElementBlock,e as createBaseVNode,u as unref,n as normalizeClass,f as toDisplayString,g as withModifiers,p as pushScopeId,h as popScopeId,W as Web3Provider,i as reactive,j as computed,I as InfuraProvider,C as Contract,k as watch,l as provide,m as readonly,q as renderSlot,s as utils,v as toRaw,B as BigNumber,x as inject,y as createVNode,z as isRef,F as Fragment,A as renderList,D as createCommentVNode,E as createBlock,G as createTextVNode,H as withCtx,J as createApp}from"./vendor.3cf1d123.js";const p=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}};p();var TokenRenderer_vue_vue_type_style_index_0_scoped_true_lang="",_export_sfc=(e,t)=>{for(const[a,o]of t)e[a]=o;return e};const _hoisted_1$7=["width","height"],_sfc_main$8=defineComponent({props:{formula:{type:String,required:!0},params:{type:Array,required:!0},size:{type:Number,required:!0},scaled:{type:Boolean,required:!1},fillStyle:{type:String,required:!1}},setup(__props){const props=__props,{formula,params}=toRefs(props),canvas=ref(null),{size}=props,sanitizedEval=f=>(f=f.replace(/[^a-zA-Z0-9=<>*+-\/().&^!|%;?:;{}]/g,""),eval(`({x,y,p1,p2,p3,p4,p5,p6,p7,p8,p9}) => ${f}`)),parseParams=e=>Object.fromEntries(e.map((t,a)=>[`p${a+1}`,t])),draw=(e,t,a,o)=>{try{let n=sanitizedEval(a),s=parseParams(o);e.clearRect(0,0,t,t);let r=x({},s);for(r.x=-t/2;r.x<t/2;r.x++)for(r.y=-t/2;r.y<t/2;r.y++)n(r)&&e.fillRect(r.x+t/2,r.y+t/2,1,1)}catch(n){console.log(n)}};let stopWatching;return onMounted(()=>{const t=canvas.value.getContext("2d");t.fillStyle=props.fillStyle||"#ddd",stopWatching=watchEffect(()=>draw(t,size,formula.value,params.value))}),onUnmounted(()=>{stopWatching()}),(e,t)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["renderer",{scaled:__props.scaled}])},[createBaseVNode("canvas",{class:"canvas",ref:(a,o)=>{o.canvas=a,canvas.value=a},width:unref(size),height:unref(size)},null,8,_hoisted_1$7)],2))}});var TokenRenderer=_export_sfc(_sfc_main$8,[["__scopeId","data-v-597bb71a"]]);const _hoisted_1$6={class:"text-input"},_hoisted_2$6=createBaseVNode("label",null,"forumla",-1),_hoisted_3$5=["value"],_sfc_main$7=defineComponent({props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const a=n=>{var s;((s=n.key.match(/[^ \[\]a-zA-Z0-9=<>*+-\/().&^!|%;?:]/))==null?void 0:s.length)&&n.preventDefault()},o=n=>{t("update:modelValue",n.target.value)};return(n,s)=>(openBlock(),createElementBlock("div",_hoisted_1$6,[_hoisted_2$6,createBaseVNode("input",{type:"text",value:e.modelValue,onKeydown:s[0]||(s[0]=r=>a(r)),onInput:s[1]||(s[1]=r=>o(r))},null,40,_hoisted_3$5)]))}});var ParameterInput_vue_vue_type_style_index_0_scoped_true_lang="";const _hoisted_1$5={class:"text-input"},_hoisted_2$5=["value"],_hoisted_3$4=["value"],_sfc_main$6=defineComponent({props:{label:{type:String,required:!0},modelValue:{type:Number,required:!0,default:()=>1}},emits:["update:modelValue"],setup(e,{emit:t}){return(a,o)=>(openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("label",null,toDisplayString(e.label),1),createBaseVNode("input",{type:"number",min:"0",max:"255",value:e.modelValue,onInput:o[0]||(o[0]=n=>t("update:modelValue",parseInt(n.target.value)))},null,40,_hoisted_2$5),createBaseVNode("input",{type:"range",min:"0",max:"255",step:"1",value:e.modelValue,onInput:o[1]||(o[1]=n=>t("update:modelValue",parseInt(n.target.value)))},null,40,_hoisted_3$4)]))}});var ParameterInput=_export_sfc(_sfc_main$6,[["__scopeId","data-v-5ac7c146"]]),MintButton_vue_vue_type_style_index_0_scoped_true_lang="";const _withScopeId$3=e=>(pushScopeId("data-v-91b8c5c0"),e=e(),popScopeId(),e),_hoisted_1$4=["disabled"],_hoisted_2$4=_withScopeId$3(()=>createBaseVNode("span",{class:"shadow"},null,-1)),_hoisted_3$3=_withScopeId$3(()=>createBaseVNode("span",{class:"edge"},null,-1)),_hoisted_4$3=_withScopeId$3(()=>createBaseVNode("span",{class:"front"}," MINT ",-1)),_hoisted_5$2=[_hoisted_2$4,_hoisted_3$3,_hoisted_4$3],_sfc_main$5=defineComponent({props:{minting:{type:Boolean,required:!0},disabled:{type:Boolean,required:!0}},emits:["click"],setup(e,{emit:t}){return(a,o)=>(openBlock(),createElementBlock("button",{disabled:e.disabled,class:normalizeClass(["pushable",{minting:e.minting}]),onClick:o[0]||(o[0]=withModifiers(n=>t("click"),["stop","prevent"]))},_hoisted_5$2,10,_hoisted_1$4))}});var MintButton=_export_sfc(_sfc_main$5,[["__scopeId","data-v-91b8c5c0"]]);const initMetamask=async e=>{const t=window.ethereum||window.web3&&window.web3.currentProvider;if(t){const a=new Web3Provider(t,"any");a.on("network",(h,B)=>{d(h.chainId)});const o=ref({}),n=ref([]),s=ref(0),r=h=>{n.value=h,o.value=a.getSigner()},d=h=>{s.value=h};t.on("accountsChanged",r);const i=async()=>{r(await a.listAccounts())};return{signer:o,chainId:s,accounts:n,connect:async()=>{s.value!=e&&await t.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x"+e.toString(16)}]}),i(),n.value.length==0&&await t.request({method:"eth_requestAccounts"})},checkConnection:i,clearListeners:()=>{t.removeListener("accountsChanged",r)}}}else return Promise.reject("So far we just support Metamask \u{1F98A}")},{formatEther}=utils,contractAddress="0xa8A0d755b9466162672179570c548842Ecf5A47f",networkId=parseInt("42"),contractAbi=["function name() view returns (string)","function totalSupply() view returns (uint)","function tokenByIndex(uint index) view returns (uint)","function tokenMetadata(uint tokenId) view returns (tuple(address,address,string,uint[],uint,uint))","function tokenURI(uint tokenId) view returns (string)","function mintPrice(uint totalSupply) view returns (uint)","function burnPrice(uint sequence) view returns (uint)","function mint(string formula, uint8[] params) payable returns (uint)","function getClaimableBalance(address owner) view returns (uint)","function burn(uint tokenId) returns (boolean)","function claim() returns (boolean)"],state=reactive({totalSupply:0,accounts:[],account:computed(()=>state.accounts.length>0&&state.accounts[0].toLowerCase()||""),connected:computed(()=>state.validNetwork&&state.accounts.length>0),contractAddress,signer:void 0,listing:[],network:0,validNetwork:computed(()=>!!state.network&&state.network==networkId),nextPrice:"0",providerError:"",claimableBalance:"0"}),infura=new InfuraProvider(networkId,"51db74c752774749a1a8aae509f4cd87"),infuraContract=new Contract(contractAddress,contractAbi,infura),fetchTokenMetadata=async e=>{let t=await infuraContract.tokenMetadata(e).catch(handleVMException);return parseTokenMetadata(t)},fetchMintPrice=async e=>{const t=await infuraContract.mintPrice(e+1);return formatEther(t)};watch(()=>state.totalSupply,async(e,t)=>{state.nextPrice=await fetchMintPrice(e)});const fetchTotalSupply=async()=>{state.totalSupply=(await infuraContract.totalSupply()).toNumber()},fetchClaimableBalance=async e=>formatEther(await infuraContract.getClaimableBalance(e)),fetchBurnPrice=async e=>formatEther(await infuraContract.burnPrice(e));watch(()=>state.account,async(e,t)=>{e&&e.length>0&&(state.claimableBalance=await fetchClaimableBalance(e))});const parseTokenMetadata=e=>({owner:e[0],minter:e[1],attributes:{formula:e[2],params:e[3].map(t=>t.toNumber())},tokenId:e[4].toNumber(),sequence:e[5].toNumber()}),fetchListing=async()=>{const e=await Promise.all(Array.apply(null,Array(state.totalSupply)).map(async(t,a)=>{let o=await infuraContract.tokenByIndex(a);return fetchTokenMetadata(o)}));state.listing=e.sort((t,a)=>t.tokenId>a.tokenId?-1:1)},mint=async(e,t=[],a)=>{const o=new Contract(contractAddress,contractAbi,toRaw(state.signer)),n=await o.mintPrice(a.value+1),s=await(await o.mint(e,t,{value:n}).catch(handleVMException)).wait().catch(handleVMException),r=BigNumber.from(s.logs[0].topics[3]).toNumber();return handleMintedToken(r),r},burn=async e=>{await(await new Contract(contractAddress,contractAbi,toRaw(state.signer)).burn(e).catch(handleVMException)).wait().catch(handleVMException),handleBurnedToken(e)},claim=async()=>{await(await new Contract(contractAddress,contractAbi,toRaw(state.signer)).claim().catch(handleVMException)).wait().catch(handleVMException)},handleMintedToken=async e=>{let t=await fetchTokenMetadata(e);state.listing.unshift(t),state.totalSupply+=1},handleBurnedToken=e=>{state.listing=state.listing.filter(t=>t.tokenId!=e),state.totalSupply-=1},handleVMException=e=>{let t="";if(e.code==4001)t="Signature rejected";else if(e.data.message&&e.data.message.indexOf("(")>-1){t=e.data.message.match(/'(.*?)'/)[1];let a=t.split("(")[0],o=t.match(/\((.*?)\)/)[1].replace(" ","").split(",");switch(a){case"InsufficientFunds":t=parseInsufficientFunds({available:parseInt(o[0]),required:parseInt(o[1])})}}return Promise.reject(t)},parseInsufficientFunds=e=>`Transaction minumum amount ${e.required} ETH, sent ${e.available} ETH`,ContractStateSymbol=Symbol("Contract state provider identifier"),ContractCallsSymbol=Symbol("Contract calls provider identifier"),_sfc_main$4={setup(){let e;const t=async()=>{try{await e.connect()}catch(a){a.code===4001?handleVMException(a):console.log(a)}};provide(ContractStateSymbol,toRefs(readonly(state))),provide(ContractCallsSymbol,{mint,burn,claim,connect:t,fetchTotalSupply,fetchBurnPrice}),onMounted(async()=>{try{e=await initMetamask(networkId)}catch(a){state.providerError=a}e&&(await e.checkConnection(),state.accounts=e.accounts,state.network=e.chainId,state.signer=e.signer),await fetchTotalSupply(),await fetchListing()}),onUnmounted(()=>{e&&e.clearListeners()})}};function _sfc_render(e,t,a,o,n,s){return renderSlot(e.$slots,"default")}var ContractProvider=_export_sfc(_sfc_main$4,[["render",_sfc_render]]),TokenForm_vue_vue_type_style_index_0_scoped_true_lang="";const _withScopeId$2=e=>(pushScopeId("data-v-0e7a0b82"),e=e(),popScopeId(),e),_hoisted_1$3={class:"center"},_hoisted_2$3={key:0},_hoisted_3$2={class:"center"},_hoisted_4$2=createTextVNode(" Current price "),_hoisted_5$1={class:"price"},_hoisted_6$1=_withScopeId$2(()=>createBaseVNode("a",{href:"https://github.com/binaries-eth/binaries#tokenomics",class:"link"},"(tokenomics info)",-1)),_hoisted_7={class:"button-container"},_hoisted_8={key:2,href:"https://metamask.io",target:"_blank"},_hoisted_9={key:0,class:"center"},_hoisted_10={key:1,class:"center"},_hoisted_11={class:"error"},_sfc_main$3=defineComponent({props:{formulaValue:{type:String,required:!0},paramsValues:{type:Array,required:!0}},emits:["update:formulaValue","update:paramsValues"],setup(e,{emit:t}){const a=e,{mint:o,burn:n,connect:s,fetchTotalSupply:r,fetchBurnPrice:d}=inject(ContractCallsSymbol),{account:i,connected:m,totalSupply:k,nextPrice:h,listing:B,providerError:b}=inject(ContractStateSymbol),_=ref({}),V=ref("0"),$=computed(()=>!!_.value),y=ref(!1),w=ref(""),E=computed(()=>_.value&&_.value.owner&&_.value.owner.toLowerCase()),M=l=>{var c,u;return((u=(c=l.match(/p[0-9]+/g))==null?void 0:c.filter((v,g,j)=>j.indexOf(v)==g))==null?void 0:u.length)||0},C=computed(()=>Object.fromEntries(unref(B).map(l=>[[l.attributes.formula,...l.attributes.params].join(","),l]))),S=l=>C.value[l.join(",")],A=watch(()=>[a.formulaValue,...a.paramsValues],(l,c)=>{const u=M(l[0]);u!=a.paramsValues.length&&(a.paramsValues.length+=u-a.paramsValues.length,t("update:paramsValues",Array.apply(null,a.paramsValues).map(v=>v||1))),_.value=S(l),t("update:formulaValue",a.formulaValue)});watch(()=>C.value,()=>{_.value=S([a.formulaValue,...a.paramsValues])}),watch(()=>_.value,async(l,c)=>{l&&(V.value=await d(l.sequence))});const P=async()=>{y.value=!0;const l=a.formulaValue.replace(/[ ]/g,"").replaceAll("console","").replaceAll("eval",""),c=a.paramsValues;await o(l,c,k).catch(T),y.value=!1},T=async l=>{w.value=l},q=()=>{w.value=""},L=l=>Math.floor(Math.random()*l),R=()=>{t("update:paramsValues",a.paramsValues.map(()=>L(255)))};return onMounted(async()=>{}),onUnmounted(()=>{A()}),(l,c)=>(openBlock(),createElementBlock("div",null,[createVNode(_sfc_main$7,{modelValue:e.formulaValue,"onUpdate:modelValue":c[0]||(c[0]=u=>isRef(formulaValue)?formulaValue.value=u:null)},null,8,["modelValue"]),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.paramsValues,(u,v)=>(openBlock(),createBlock(ParameterInput,{label:"P"+(v+1),modelValue:e.paramsValues[v],"onUpdate:modelValue":g=>e.paramsValues[v]=g,modelModifiers:{number:!0}},null,8,["label","modelValue","onUpdate:modelValue"]))),256)),createBaseVNode("div",_hoisted_1$3,[unref($)?(openBlock(),createElementBlock("span",_hoisted_2$3,"These params are already minted ")):createCommentVNode("",!0),createBaseVNode("span",{class:"link",onClick:c[1]||(c[1]=u=>R())},"(randomise)")]),createBaseVNode("div",_hoisted_3$2,[_hoisted_4$2,createBaseVNode("span",_hoisted_5$1,toDisplayString(unref(h))+"\u039E ",1),createBaseVNode("span",{class:"link",onClick:c[2]||(c[2]=u=>unref(r)())},"(refresh)"),_hoisted_6$1]),createBaseVNode("div",_hoisted_7,[unref(m)?(openBlock(),createBlock(MintButton,{key:0,disabled:unref($)||y.value,minting:y.value,onClick:c[3]||(c[3]=u=>P())},null,8,["disabled","minting"])):unref(b)?unref(b)?(openBlock(),createElementBlock("a",_hoisted_8,"(install Metamask \u{1F98A} to mint)")):createCommentVNode("",!0):(openBlock(),createElementBlock("span",{key:1,class:"link",onClick:c[4]||(c[4]=u=>unref(s)())},"(connect)"))]),unref(E)==unref(i)?(openBlock(),createElementBlock("div",_hoisted_9,[createBaseVNode("span",{class:"link",onClick:c[5]||(c[5]=u=>unref(n)(_.value.tokenId))},"(burn for "+toDisplayString(V.value)+"\u039E)",1)])):createCommentVNode("",!0),w.value?(openBlock(),createElementBlock("div",_hoisted_10,[createBaseVNode("span",_hoisted_11,toDisplayString(w.value),1),createBaseVNode("span",{class:"link",onClick:c[6]||(c[6]=u=>q())},"(OK, close)")])):createCommentVNode("",!0)]))}});var TokenForm=_export_sfc(_sfc_main$3,[["__scopeId","data-v-0e7a0b82"]]),ConnectButton_vue_vue_type_style_index_0_scoped_true_lang="";const _hoisted_1$2={key:0},_hoisted_2$2={key:1},_hoisted_3$1={key:1},_hoisted_4$1={key:0,class:"with_space"},_hoisted_5=createTextVNode(" Accrued "),_hoisted_6={class:"amount"},_sfc_main$2=defineComponent({setup(e){const{connect:t,claim:a}=inject(ContractCallsSymbol),{connected:o,account:n,providerError:s,claimableBalance:r}=inject(ContractStateSymbol);return(d,i)=>(openBlock(),createElementBlock("div",null,[unref(s)?(openBlock(),createElementBlock("div",_hoisted_1$2,toDisplayString(unref(s)),1)):(openBlock(),createElementBlock("div",_hoisted_2$2,[unref(o)?(openBlock(),createElementBlock("div",_hoisted_3$1,[parseFloat(unref(r))>0?(openBlock(),createElementBlock("span",_hoisted_4$1,[_hoisted_5,createBaseVNode("span",_hoisted_6,toDisplayString(unref(r))+"\u039E ",1),createBaseVNode("span",{class:"link",onClick:i[1]||(i[1]=m=>unref(a)())},"(claim)")])):createCommentVNode("",!0),createBaseVNode("span",null,"Connected as "+toDisplayString(unref(n)),1)])):(openBlock(),createElementBlock("button",{key:0,onClick:i[0]||(i[0]=m=>unref(t)()),ref:(m,k)=>{k.connect_button=m}},"CONNECT",512))]))]))}});var ConnectButton=_export_sfc(_sfc_main$2,[["__scopeId","data-v-8a473a60"]]),TokenList_vue_vue_type_style_index_0_scoped_true_lang="";const _withScopeId$1=e=>(pushScopeId("data-v-27af4aba"),e=e(),popScopeId(),e),_hoisted_1$1=["onClick"],_hoisted_2$1=_withScopeId$1(()=>createBaseVNode("span",{class:"shadow"},null,-1)),_sfc_main$1=defineComponent({emits:["selected"],setup(e,{emit:t}){const a=n=>{const s=JSON.parse(JSON.stringify(n));t("selected",s)},{listing:o}=inject(ContractStateSymbol);return onMounted(async()=>{}),onUnmounted(()=>{}),(n,s)=>(openBlock(),createElementBlock("section",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(o),r=>(openBlock(),createElementBlock("div",{class:"box",onClick:d=>a(r),key:r.tokenId},[_hoisted_2$1,createVNode(TokenRenderer,{class:"front",scaled:"",formula:r.attributes.formula,params:r.attributes.params,size:512},null,8,["formula","params"])],8,_hoisted_1$1))),128))]))}});var TokenList=_export_sfc(_sfc_main$1,[["__scopeId","data-v-27af4aba"]]),App_vue_vue_type_style_index_0_scoped_true_lang="";const _withScopeId=e=>(pushScopeId("data-v-5767c46e"),e=e(),popScopeId(),e),_hoisted_1={class:"container"},_hoisted_2={class:"navigation"},_hoisted_3=_withScopeId(()=>createBaseVNode("span",{class:"logo"},"BINARIES",-1)),_hoisted_4={class:"grid"},_sfc_main=defineComponent({setup(e){const t=512,a=ref("!((x ^ y) % p1)"),o=ref([7]),n=ref(!1),s=d=>{n.value=d},r=d=>{a.value=d.attributes.formula,o.value=d.attributes.params};return(d,i)=>(openBlock(),createBlock(ContractProvider,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[_hoisted_3,createVNode(ConnectButton,{onConnected:s})]),createBaseVNode("div",_hoisted_4,[createVNode(TokenRenderer,{class:"shadow",formula:a.value,params:o.value,size:t},null,8,["formula","params"]),createVNode(TokenForm,{class:"editor","formula-value":a.value,"onUpdate:formula-value":i[0]||(i[0]=m=>a.value=m),"params-values":o.value,"onUpdate:params-values":i[1]||(i[1]=m=>o.value=m),connected:n.value},null,8,["formula-value","params-values","connected"])]),createVNode(TokenList,{onSelected:r})])]),_:1}))}});var App=_export_sfc(_sfc_main,[["__scopeId","data-v-5767c46e"]]),global="";createApp(App).mount("#app");
